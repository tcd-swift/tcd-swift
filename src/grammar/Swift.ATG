COMPILER Swift

/*--------------------------------------------------------------------------*/

CHARACTERS
  letter = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".
  digit = "0123456789".
  cr  = '\r'.
  lf  = '\n'.
  tab = '\t'.
  space = '\u0020'.
  singleQuote = '\''.
  doubleQuote = '\"'.
  dot = '.'.
  characters = ANY - cr - lf - singleQuote.
  ascii = ANY - cr - lf - doubleQuote.
  

TOKENS
  ident  = letter {letter | digit | dot}.
  number = digit {digit}.
  string = '"' {ascii} '"'.
  char   = '\'' [characters] '\''.

COMMENTS FROM "/*" TO "*/" NESTED
COMMENTS FROM "//" TO lf

IGNORE cr + lf + tab

PRODUCTIONS

/*------------------------------------------------------------------------
Operators
------------------------------------------------------------------------*/

/*------------------------------------------------------------------------*/

//No associativity, precedence level 160

ExponentiativeOp
= ( "<<"
  | ">>"
  ).

/*------------------------------------------------------------------------*/

//Left associative, precedence level 150

MultiplicativeOp
=
  ( "*"
  | "/"
  | "%"
  | "&*"
  | "&/"
  | "&%"
  | "&"
  ).

/*------------------------------------------------------------------------*/

//Left associative, precednce level 140

AdditiveOp
= ( "+"
  | "-"
  | "&+"
  | "&-"
  | "|"
  | "^"
  ).

/*------------------------------------------------------------------------*/

//No associativity, precedence level 135

RangeOp
= ( "..<"
  | "..."
  ).

/*------------------------------------------------------------------------*/

//No associativity, precedence level 132

CastOp
= ( "is"
  | "as"
  ).

/*------------------------------------------------------------------------*/

//No associativity, precedence level 130

ComparativeOp
=
  ( "=="
  | "<"  
  | ">"  
  | "<="
  | ">="
  | "!="
  | "==="
  | "!=="
  | "~="
  ).

/*------------------------------------------------------------------------*/

//Left associative, precedence level 120

ConjuctiveOp
= ( "&&""
  ).
  
/*------------------------------------------------------------------------*/

//Left associative, precedence level 110

DisjunctiveOp
= ( "||"
  ).

/*------------------------------------------------------------------------*/

//Right associative, precedence level 110

NilCoalescingOp
= ( "??"
  ).

/*------------------------------------------------------------------------*/

//Right associative, precedence level 100

TernaryOp
= ( "?"
  ).

/*------------------------------------------------------------------------*/

//Right associative, precedence level 90

AssignmentOps
= 
  ( "="  
  | "*="  
  | "/="  
  | "%="  
  | "+="  
  | "-="  
  | "<<="  
  | ">>="  
  | "&="  
  | "^="  
  | "|="  
  | "&&="  
  | "||="  
  ).

/*------------------------------------------------------------------------*/

Ident
= ident

/*------------------------------------------------------------------------*/

/*------------------------------------------------------------------------
Expressions
------------------------------------------------------------------------*/

/*------------------------------------------------------------------------*/

Expressions
= Ternary

/*------------------------------------------------------------------------*/

Ternary
= NilCoalescing
  [ TernaryOp Expression ":" Expression ].

/*------------------------------------------------------------------------*/

NilCoalescing
= Disjunctive
  { NilCoalescingOp Disjunctive }.

/*------------------------------------------------------------------------*/

Disjunctive
= Conjuctive
  { DisjunctiveOp Conjuctive }.

/*------------------------------------------------------------------------*/

Conjuctive
= Comparative
  { ConjuctiveOp Comparative }.

/*------------------------------------------------------------------------*/

Comparative
= Cast
  { ComparativeOp Cast }.

/*------------------------------------------------------------------------*/

Cast
= Range
  { CastOp Range }.

/*------------------------------------------------------------------------*/

Range
= Additive
  { RangeOp Additive }.

/*------------------------------------------------------------------------*/

Additive
= Multiplicative
  { AdditiveOp Multiplicative}.

/*------------------------------------------------------------------------*/

Multiplicative
= Exponetative
  { MultiplicativeOp Exponetative}.

/*------------------------------------------------------------------------*/

Exponetative
= Factor 
  { ExponentiativeOp Factor }.

/*------------------------------------------------------------------------*/

Factor
=
  ( Ident
  | number                      
  | char                        
  | string                      
  | '-' Factor
  | "true"                      
  | "false"                     
  ).

/*------------------------------------------------------------------------*/

BranchStatement = ( IfStatement | SwitchStatement ).
LoopStatement = ( WhileStatement | ForStatement ).

/*------------------------------------------------------------------------*/

IfStatement
= "if"
  '(' Expression ')'
      Statement
  [ 
    "else if"
    Statement
  ]
  [
    "else"
    Statement
  ]
.
/*------------------------------------------------------------------------*/

SwitchStatement
= "switch"
  '(' Expression ')'        
  '{'

  {
    "case" [ "where" Expression ]':'
     Statement
  }

  "default" ':' Statement

  '}'
.
/*------------------------------------------------------------------------*/

WhileStatement
= "while"
  '(' Expression ')'
  '{' Statement '}'
.

/*------------------------------------------------------------------------*/

ForStatement
= "for"
  '(' Ident "=" Expression ';' Expression ';' Ident "=" Expression ')'
  '{' Statement '}'
.

/*------------------------------------------------------------------------*/

Statement

= Ident AssignmentOp Expression';'
| BranchStatement';
| LoopStatement';'
| '{' { Statement } '}' .

/*------------------------------------------------------------------------*/

/*------------------------------------------------------------------------
Declarations
------------------------------------------------------------------------*/

/*------------------------------------------------------------------------*/

attributes
=
  .

/*------------------------------------------------------------------------*/

constant_declaration
= [attributes]
  [declaration_specifiers]
  "let"
  pattern_initializer_list
  .

/*------------------------------------------------------------------------*/

declaration_specifiers
=
  .

/*------------------------------------------------------------------------*/

expression
=
  .

/*------------------------------------------------------------------------*/

initializer
= expression
  .

/*------------------------------------------------------------------------*/

pattern_initializer_list
=
  .

/*------------------------------------------------------------------------*/

Swift
=
  .

END Swift.